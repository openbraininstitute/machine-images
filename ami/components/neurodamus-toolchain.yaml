---
name: neurodamus-toolchain
description: Install toolchain for neurodamus
schemaVersion: 1.0
phases:
  - name: build
    steps:
      - name: EFA-and-OpenMPI
        action: ExecuteBash
        inputs:
          commands:
            - |-
              #!/bin/bash
              set -euo pipefail
              set -x
              echo "Start openbraininstitute step: EFA-and-OpenMPI"
              dnf -y install bison cpp cmake gcc-c++ flex git libfl-devel python3.11-devel python3-pip python-devel python3-virtualenv readline-devel ninja-build
              cd /tmp
              curl -O https://efa-installer.amazonaws.com/aws-efa-installer-latest.tar.gz
              tar xf aws-efa-installer-latest.tar.gz
              cd aws-efa-installer
              ./efa_installer.sh -y --skip-kmod --mpi=openmpi5
              cd -
              rm -rf /tmp/aws*
              echo "End openbraininstitute step: EFA-and-OpenMPI"
